---
title: "Lab 4"
#author: "Insert Name"
date: "Math 241, Week 4"
output:
  pdf_document
urlcolor: blue
---
```{r setup, include=FALSE}
# Do not modify this chunk.
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r}
# Put all necessary libraries here
library(tidyverse)
library(ggplot2)
library(tidytuesdayR)
library(readr)
library(datapasta)
library(dplyr)

#using the libraries
covid_survey <- read_csv("C:/Users/agjjo/OneDrive/Documents/GitHub/math241/labs/lab04/data/covid-survey.csv")
#View(covid_survey)
dim(covid_survey)
```

### Problem 1: COVID survey - interpretation
first thing that jumps out to me is that these nursing students do not seem to trust the vaccine
Look at age * safe: the mid 20's students have the highest trust (older/younger rated lower with lower variation)
the only clear indicator for if someone is queer was the gender question but, its seems like queer(in this case, nonbinary) students were more likely to trust the vaccine
North american indigenous students had high variability all responses. This makes me think that that grouping on it's own is a poor predictor and if you wanted better info about that population(those populations) you would have to bring in more context
### Problem 2: COVID survey - reconstruct
```{r}

# Creating a function to delete rows with a certain minimum number of NA's
delete_na <- function(DF, n = 0) {
  DF[rowSums(is.na(DF)) <= n, ]
}

# Assuming 'covid_survey' is your data frame
covid_cleaned <- delete_na(covid_survey, 12)


#trying to rename the columns to not be the survey question instead of "...#" 
covid_cleaned <- covid_cleaned %>%
  rename(...5 = exp_race)


# Relabeling survey responses
covid_cleaned <- covid_cleaned %>%
  mutate(exp_race = case_when(
    "...5" == 1 ~ "American Indian / Alaskan native",
    '5' == 2 ~ "Asian",
    '5' == 3 ~ "Black / African American",
    '5' == 4 ~ "Native Hawaiian / Other Pacific Islander",
    '5' == 5 ~ "White"
  ))

# Showing dimensions of the cleaned data
dim(covid_cleaned)











```